<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>TP2 - Utilisation de données externes</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="libs/highlightjs-1.1/highlight.js"></script>
<!--
    Font Awesome
-->
<script src="https://use.fontawesome.com/32d8325004.js"></script>
<link rel="stylesheet" href="libs/font-awesome-4.7.0/css/font-awesome.min.css">

<!--
    CSS perso
-->
<style>
    .contenu {
        margin-bottom: 50px;
    }

    .contact-liens {
        text-align: center;
    }
    .contact-liens:hover {
        text-decoration: none;
    }
    .contact-icones {
        height: 30px;
    }

    /* Espacement pour barre du haut et pied de page */
    #header, .section.level1 {
        margin-top: 60px;
        margin-bottom: 60px;
    }
    /* Espacement pour table des matières */
    #TOC {
        margin-top: 100px;
    }
    
    .footer {
        position: fixed;
        width: 100%;
        text-align: center;
        bottom: 0;
        left: 0;
        background-color: #E6E6E6;
    }
</style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="libs/bootstrap-journal.min.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->





<div class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-main">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">FX Jollois</a>
    </div>
    <div id="navbar-main" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button">Données <span class="caret"></span></a>
          <ul class="dropdown-menu">
              <li><a href="accesdonnees.html">A télécharger</a></li>
              <li><a href="donnees-integrees-r.html">Sous R</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button">Enseignement <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li class="dropdown-header">DUT 1ère année</li>
            <li><a href="exploitation-donnees.html">Exploitation de données</a></li>
            <li><a href="initiation-a-r.html">Initiation à R</a></li>
            <li><a href="reporting.html">Reporting</a></li>
            <li><a href="complements-r.html">Compléments sur R</a></li>
            <li class="dropdown-header">DUT 2ème année</li>
            <li><a href="prog-stat-r.html">Programmation statistique avec R</a></li>
            <li class="dropdown-header">LP MDS Santé</li>
            <li><a href="info-dec-sante.html">Informatique décisionnelle</a></li>
            <li class="dropdown-header">DU Analyste Big Data</li>
            <li><a href="initiation-r-du.html">Initiation à R</a></li>
            <li><a href="connexion-r-mongodb.html">Connexion entre R et MongoDB</a></li>
            <li class="dropdown-header">DU Dataviz</li>
            <li><a href="analyse-donnees.html">Analyse de données</a></li>
            <li><a href="visualisation-donnees.html">Visualisation de données - R</a></li>
            <li><a href="visualisation-donnees-tableau.html">Visualisation de données - Tableau</a></li>
            <li><a href="visualisation-donnees-d3.html">Visualisation de données - D3</a></li>
            <li role="separator" class="divider"></li>
            <li class="dropdown-header">Master</li>
            <li><a href="slides/cnam-classif-modeles.html">Classification et Modèles de mélange</a></li>
            <li><a href="analyse-donnees-massives.html">Analyse de Données Massives</a></li>
            <li class="dropdown-header">Iran</li>
            <li><a href="stat-prog-R.html">Statistical Programming using R</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button">Recherche <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="recherche.html">Sujets</a></li>
            <li><a href="publications.html">Publications</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button">Réalisations <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="realisations.html">Détail</a></li>
            <li role="separator" class="divider"></li>
            <li><a href="http://up5.fr/explore-data" target="_blank">explore-data</a></li>
            <li><a href="http://fxjollois.github.io/cours-sql/" target="_blank">Appli web de cours pour SQL</a></li>
          </ul>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container-fluid -->
</div>
<div class="contenu">

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">TP2 - Utilisation de données externes</h1>
<h3 class="subtitle"><em>Initiation a <code>R</code> - STID 1ère année</em></h3>

</div>


<div id="type-de-donnees" class="section level2">
<h2>Type de données</h2>
<div id="transformation-de-type" class="section level3">
<h3>Transformation de type</h3>
<p>Dans <code>R</code>, il est possible de passer d’un type à l’autre, quand cela est possible, avec les commandes <code>as.nouveautype()</code>. Ci-dessous sont présentés deux exemples simples (passage de <code>numeric</code> à <code>character</code> et inversement).</p>
<pre class="r"><code>&gt; as.character(c(1, 3, 5))</code></pre>
<pre><code>[1] &quot;1&quot; &quot;3&quot; &quot;5&quot;</code></pre>
<pre class="r"><code>&gt; as.numeric(c(&quot;1&quot;, &quot;3&quot;, &quot;5&quot;))</code></pre>
<pre><code>[1] 1 3 5</code></pre>
<p>Il existe d’autres commandes de ce type que vous découvrirez progressivement.</p>
</div>
<div id="factor" class="section level3">
<h3><code>factor</code></h3>
<p>Nous avons déjà vu dans le TP1 des variables <code>numeric</code> dans un <code>data.frame</code> avec <code>mtcars</code>, ainsi qu’un vecteur de <code>character</code> avec le nom des colonnes de cette table.</p>
<pre class="r"><code>&gt; class(mtcars$mpg)</code></pre>
<pre><code>[1] &quot;numeric&quot;</code></pre>
<pre class="r"><code>&gt; class(rownames(mtcars))</code></pre>
<pre><code>[1] &quot;character&quot;</code></pre>
<p>Il existe dans <code>R</code> un moyen de stocker des variables qualitatives, avec le type <code>factor</code>. Si nous prenons la variable <code>am</code> de <code>mtcars</code>, indiquant le type de transmission (boîte de vitesses) de la voiture, et qui vaut <code>0</code> (automatique) ou <code>1</code> (manuelle). C’est clairement une variable qualitative. Elle est stockée au format <code>numeric</code>, mais on peut la passer soit en <code>character</code>, soit en <code>factor</code>.</p>
<pre class="r"><code>&gt; mtcars$am</code></pre>
<pre><code> [1] 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 1 1 1 1 1 1 1</code></pre>
<pre class="r"><code>&gt; as.character(mtcars$am)</code></pre>
<pre><code> [1] &quot;1&quot; &quot;1&quot; &quot;1&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot;
[18] &quot;1&quot; &quot;1&quot; &quot;1&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;1&quot; &quot;1&quot; &quot;1&quot; &quot;1&quot; &quot;1&quot; &quot;1&quot; &quot;1&quot;</code></pre>
<pre class="r"><code>&gt; as.factor(mtcars$am)</code></pre>
<pre><code> [1] 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 1 1 1 1 1 1 1
Levels: 0 1</code></pre>
<p>On remarque pour le type <code>factor</code>, en plus des valeurs, <code>R</code> garde les modalités de la variable (nommées <code>levels</code> ici).</p>
<p>On dispose de la fonction <code>factor</code>, qui transforme une variable en <code>factor</code>. L’intérêt de celle-ci, par rapport à <code>as.factor()</code>, est qu’il est possible de paramètrer le nom des modalités.</p>
<pre class="r"><code>&gt; factor(mtcars$am)</code></pre>
<pre><code> [1] 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 1 1 1 1 1 1 1
Levels: 0 1</code></pre>
<pre class="r"><code>&gt; factor(mtcars$am, labels = c(&quot;automatic&quot;, &quot;manual&quot;))</code></pre>
<pre><code> [1] manual    manual    manual    automatic automatic automatic automatic
 [8] automatic automatic automatic automatic automatic automatic automatic
[15] automatic automatic automatic manual    manual    manual    automatic
[22] automatic automatic automatic automatic manual    manual    manual   
[29] manual    manual    manual    manual   
Levels: automatic manual</code></pre>
</div>
</div>
<div id="modification-de-data.frame" class="section level2">
<h2>Modification de <code>data.frame</code></h2>
<div id="creation" class="section level3">
<h3>Création</h3>
<p>La fonction <code>data.frame</code> permet de créer un <code>data.frame</code> à partir de vecteurs. Elle prend en paramètre les vecteurs, qu’on peut nommer directement.</p>
<pre class="r"><code>&gt; v = 1:100
&gt; d = data.frame(
+     x = v,
+     y = v * log(v)
+ )
&gt; head(d)</code></pre>
<pre><code>  x         y
1 1  0.000000
2 2  1.386294
3 3  3.295837
4 4  5.545177
5 5  8.047190
6 6 10.750557</code></pre>
</div>
<div id="ajout-de-variables" class="section level3">
<h3>Ajout de variables</h3>
<p>Il est possible d’ajouter des variables à un <code>data.frame</code> de manière assez simple.</p>
<pre class="r"><code>&gt; d$z = factor(sin(v) &gt; 0)
&gt; head(d)</code></pre>
<pre><code>  x         y     z
1 1  0.000000  TRUE
2 2  1.386294  TRUE
3 3  3.295837  TRUE
4 4  5.545177 FALSE
5 5  8.047190 FALSE
6 6 10.750557 FALSE</code></pre>
</div>
</div>
<div id="acces-aux-fichiers" class="section level2">
<h2>Accès aux fichiers</h2>
<div id="adressage-relatif-ou-absolu" class="section level3">
<h3>Adressage relatif ou absolu</h3>
<p>Dans tout langage de programmation, dès qu’on veut accéder à un fichier (ou l’écrire), on a le choix entre deux types d’adressage pour situer ce fichier :</p>
<ul>
<li><strong>relatif</strong> : le chemin vers le fichier est indiqué par rapport au répertoire courant
<ul>
<li><code>&quot;fichier.ext&quot;</code> : le fichier est dans le répertoire courant</li>
<li><code>&quot;rep/fichier.ext&quot;</code> : le fichier est dans le sous-dossier <code>&quot;rep&quot;</code> présent dans le répertoire courant</li>
<li><code>&quot;../fichier.ext&quot;</code>: le fichier est dans le répertoire contenant le répertoire courant</li>
<li>…</li>
</ul></li>
<li><strong>absolu</strong> : le chemin vers le fichier est défini de manière absolument et ne dépend pasdu répertoire courant
<ul>
<li><code>&quot;C:/chemin/vers/rep/fichier.ext&quot;</code> : on indique clairement où se situe le fichier</li>
</ul></li>
</ul>
<p>L’adressage absolu est utile si vous êtes certain que le fichier ne changera jamais de place (accès à un fichier sur un serveur, travail dans un environnement fixe, …). Mais on utilise plus facilement l’adresse relatif, car les fichiers à lire ou écrire se trouve généralement dans le répertoire courant ou dans un sous-répertoire.</p>
</div>
<div id="repertoire-de-travail" class="section level3">
<h3>Répertoire de travail</h3>
<p>Dans <code>R</code>, la notion de répertoire de travail permet au logiciel de savoir où lire et écrire les fichiers (texte, image, vidéo, …). C’est le répertoire courant dans lequel le logiciel cherche. Il est possible de connaître ce répertoire avec la commande <code>getwd()</code></p>
<pre class="r"><code>&gt; getwd()</code></pre>
<pre><code>[1] &quot;/home/francois-xavier/Documents/fxjollois.github.io/archive-2016-2017&quot;</code></pre>
<p>Il est possible de le changer via la commande <code>setwd()</code>. On vérifie ensuite que la commande a bien fonctionné.</p>
<pre class="r"><code>&gt; setwd(&quot;/Users/fxjollois/Documents/&quot;)
&gt; getwd()</code></pre>
</div>
</div>
<div id="importation-de-donnees-texte" class="section level2">
<h2>Importation de données texte</h2>
<p>Il est possible d’importer des données provenannt de fichiers texte avec la commande <code>read.table()</code>, qui a les paramètres principaux suivants (avec <code>valeur</code> par défaut éventuelle) :</p>
<ul>
<li><code>file</code> : nom du fichier</li>
<li><code>header</code> : présence ou non des noms de variables (<code>FALSE</code>)</li>
<li><code>sep</code> : séparateur de variable (` `)</li>
<li><code>na.strings</code> : chaîne(s) pour valeurs manquantes (<code>NA</code>)</li>
<li><code>skip</code> : nombre de lignes à ne pas prendre en compte en début de fichier (<code>0</code>)</li>
<li><code>nrow</code> : nombre de lignes à lire (<code>-1</code> : toutes les lignes)</li>
<li><code>stringsAsFactors</code> : transformations des chaînes en <code>factor</code> ou non (<code>TRUE</code>)</li>
<li>…</li>
</ul>
<p>Cette fonction renvoie un objet de type <code>data.frame</code>.</p>
<p>Il existe quelques fonctions dérivés avec des valeurs par défaut différentes</p>
<ul>
<li><code>read.csv()</code>, <code>read.csv2()</code></li>
<li><code>read.delim()</code>, <code>read.delim2()</code></li>
</ul>
<p>Par exemple, nous disposons du fichier <a href="donnees/Iris.txt"><code>Iris.txt</code></a>, contenant les données de 150 iris (données déjà présentes dans <code>R</code> dans l’objet <code>iris</code> pour information).</p>
<object data="donnees/Iris.txt" type="text/plain" style="width: 100%">
<pre><code>impossible à afficher</code></pre>
</object>
<p>Nous remarquons les points suivants :</p>
<ul>
<li>le nom des colonnes est présent dans la première ligne</li>
<li>le séparateur de colonnes est le point-virgule (<code>&quot;;&quot;</code>)</li>
</ul>
<p>Pour importer ce fichier, nous devons donc utiliser le code suivant. Vous devez d’abord télécharger le fichier. <strong>Attention</strong> : il est supposé ici que le fichier est dans un sous-répertoire <code>donnees</code> du répertoire de travail.</p>
<pre class="r"><code>&gt; iris = read.table(&quot;donnees/Iris.txt&quot;, header = T, sep = &quot;;&quot;)
&gt; head(iris)</code></pre>
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
<p>Il est aussi possible d’écrire un fichier texte à partir d’un <code>data.frame</code>, en spécifiant aussi les paramètres d’écriture. Par exemple, le code suivant écrit les données <code>iris</code> dans un autre formalisme.</p>
<ul>
<li>le séparateur de colonnes est le <code>&quot;%&quot;</code></li>
<li>les noms des colonnes sont bien écrits</li>
<li>le nom des lignes ne sont incluses</li>
<li>le séparateur de décimales est la virgule (<code>&quot;,&quot;</code>), comme en français</li>
<li>il n’y a pas de <code>&quot;&quot;</code> ou de <code>''</code> autour des chaînes de caractères</li>
</ul>
<pre class="r"><code>&gt; write.table(iris, file = &quot;donnees/Iris_bis.txt&quot;, sep = &quot;%&quot;, 
+             row.names = FALSE, col.names = TRUE, dec = &quot;,&quot;, quote = FALSE)</code></pre>
<object data="donnees/Iris_bis.txt" type="text/plain" style="width: 100%">
<pre><code>impossible à afficher</code></pre>
</object>
<p>Il est parfois difficile de lire directement avec la commande <code>read.table()</code> ou ses dérivés. On peut utiliser dans ce cas la commande <code>readLines()</code>, qui comme son nom l’indique, lit les lignes les unes après les autres. Elle renvoie un tableau de chaîne de caractères, chaque valeur du tableau correspondant à une ligne.</p>
<pre class="r"><code>&gt; iris_lignes = readLines(&quot;donnees/Iris.txt&quot;)
&gt; length(iris_lignes)</code></pre>
<pre><code>[1] 151</code></pre>
<pre class="r"><code>&gt; iris_lignes[1]</code></pre>
<pre><code>[1] &quot;&#39;Sepal.Length&#39;;&#39;Sepal.Width&#39;;&#39;Petal.Length&#39;;&#39;Petal.Width&#39;;&#39;Species&#39;&quot;</code></pre>
<pre class="r"><code>&gt; iris_lignes[2]</code></pre>
<pre><code>[1] &quot;5.1;3.5;1.4;0.2;&#39;setosa&#39;&quot;</code></pre>
</div>
<div id="exercices" class="section level2">
<h2>Exercices</h2>
<div id="importation-de-donnees" class="section level3">
<h3>Importation de données</h3>
<p>Vous devez importer les données suivantes dans <code>R</code>.</p>
<p><a href="donnees/heart.txt"><code>heart.txt</code></a></p>
<p>Pas de difficulté spéciale ici. Le séparateur est la tabulation (<code>\t</code> en R).</p>
<object data="donnees/heart.txt" type="text/plain" style="width: 100%">
<pre><code>impossible à afficher</code></pre>
</object>
<p><a href="donnees/Detroit_homicide.txt"><code>Detroit_homicide.txt</code></a></p>
<p>Ici, les premières lignes ne sont pas à prendre en considération lors de l’importation. Et nous avons des <code>labels</code> pour les variables.</p>
<object data="donnees/Detroit_homicide.txt" type="text/plain" style="width: 100%">
<pre><code>impossible à afficher</code></pre>
</object>
<p><a href="donnees/hepatitis.TXT"><code>hepatitis.TXT</code></a></p>
<p>Attention à l’indicateur de données manquantes (<code>?</code> dans ce fichier).</p>
<object data="donnees/hepatitis.TXT" type="text/plain" style="width: 100%">
<pre><code>impossible à afficher</code></pre>
</object>
</div>
<div id="complements" class="section level3">
<h3>Compléments</h3>
<p>Reprendre l’importation du fichier <code>heart.txt</code> (cf ci-dessus), et répondre aux questions suivantes en complétant le code précédemment écrit.</p>
<ol style="list-style-type: decimal">
<li>Créer une indicatrice binaire <code>FALSE/TRUE</code> pour la présence ou non de problème de coeur (dernière variable)</li>
<li>Créer une variable comptant le nombre de fois où une variable est égale à <code>A</code> (entre <code>type_douleur</code>, <code>sucre</code>, <code>electro</code>, et <code>vaisseau</code>)</li>
<li>Créer une variable <code>factor</code> à partir de l’indicatrice binaire faite au point 1 avec comme labels des modalités <code>Présence</code> pour <code>TRUE</code> et <code>Absence</code> pour <code>FALSE</code> (refaire la variable <code>coeur</code> en quelque sorte)</li>
<li>Créer un nouveau <code>data.frame</code> avec uniquement les individus ayant strictement moins de 60 ans</li>
<li>Créer maintenant, à partir du précédent, deux <code>data.frames</code> :
<ul>
<li>une pour les hommes</li>
<li>une autre pour les femmes</li>
</ul></li>
</ol>
</div>
</div>

</div>
<div class="footer">
      Site créé avec <a href="http://www.r-project.org" target="_blank"><code>R</code></a> et la 
      librairie  <a href="http://rmarkdown.rstudio.com/" target="_blank"><code>rmarkdown</code></a>.
</div>
<script>
    $("#TOC").css("margin-top", "100px");
</script>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
